import 'server-only';

import { ShopSearchOptions } from '@/lib/api/types';

export const bannedBrands = [
  'rumgay',
  'picky zone',
  'SYN Elektirik',
  'TEX PALACE',
  "Art's",
  'MTgram',
  'ESCAPINO',
  'GökçeStore',
  'NLF COLLECTİON',
  'Birce 1971',
  'RAMBERİO',
  'Cherry Star',
  'Baftarz',
  'ZABARA',
  'BLUEMOON',
  'pares',
  'rapellin',
  'SWORD CLOTHİNG',
  'Butik',
  'ZBCLUB',
  'Boyzz',
  'BOİS BUTİK',
  'SALİH İĞDE',
  'FAVORİSPOR',
  'drillshopier',
  'LUZIN GRUP',
  'Air',
  'ART',
  'Yeliz',
  'PRC',
  'roofmen',
  'Keskin',
  'DUKA Fashion',
  'Özkan Ayakkabı',
  'Gupido',
  'Byron',
  'Ayakkabı Kozası',
  'Göknuraxu',
  'BEYOĞLUSNEAKERS',
  'Zero Shot',
];

export const bannedMerchants = [
  595038, 826737, 795050, 844832, 247779, 891209, 415416, 831862, 419425, 241454, 313145, 775397,
  317244, 825148, 315671, 106277, 920135, 692816, 675500, 527514, 107381, 638868, 188718, 142528,
  105035, 370074, 435218, 389414, 105144, 197549, 107265, 604084, 167200, 613354, 466221, 820428,
  254575, 112309, 835978, 235049, 401036, 817796, 119691, 403545, 354180, 830334, 777227, 196919,
  191456, 446617, 526575, 483874, 411243, 686130, 801866, 758991, 808944, 712910, 294481, 555405,
  918439, 696057, 471474, 453228, 128033, 430192, 569301, 316417, 500967, 231201, 758666, 629221,
  498839, 502204, 495158, 463187, 133229, 326901, 437341, 159360, 673627, 154605, 279595, 151583,
  791549, 500502, 290104, 692639, 239411, 442404, 625229, 105117, 135284, 267355, 259702, 737121,
  731898, 385279, 505720, 713134, 482016, 528064, 819230, 234584, 223968, 629362, 158463, 175630,
  174140, 711417, 361224, 471680, 356228, 118080, 395432, 124300, 678042, 116354, 186598, 806129,
  198139, 892948, 793684, 282245, 597879, 255611, 614680, 170983, 322928, 369893, 448197, 224264,
  810696, 554664, 270521, 378753, 333271, 707685, 460713, 232504, 229320, 842706, 892732, 687219,
  120459, 837587, 707080, 347649, 831050, 130195, 108889, 233898, 114603, 658470, 451767, 602526,
  907502, 462257, 893501, 425066, 128340, 702913, 196336, 469603, 744127, 806569, 867180, 583668,
  730585, 856414, 107105, 833183, 702646, 291801, 434761, 191871, 107831, 776945, 117749, 800609,
  767010, 834246, 421504, 847117, 110580, 539545, 429753, 475263, 123769, 621866, 362305, 825275,
  626332, 357, 129262, 460383, 542749, 582036, 701116, 671523, 107033, 109540, 472148, 670539,
  862165, 863463, 346997, 871144, 545102, 113000, 627903, 215704, 579540, 811771, 717646, 434790,
  142904, 893072, 469331, 802120, 314822, 222229, 110854, 815653, 367876, 852090, 114103, 647994,
  879738, 602579, 838794, 798447, 774299, 406769, 610134, 154954, 106785, 453692, 654344, 515097,
  292990, 259437, 651225, 281170, 695128, 374829, 116716, 789075, 595731, 417152, 106663, 254031,
  119589, 139383, 2975, 545372, 651493, 696304, 632933, 832471, 827616, 720769, 112216, 107329,
  463098, 380861, 106646, 862158, 160833, 733181, 918408, 374148, 330987, 252710, 360083, 109687,
  703340, 614221, 876472, 107090, 107844, 344772, 816929, 412006, 215254, 868836, 862805, 605536,
  150208, 107283, 451541, 518177, 123712, 151903, 598497, 356024, 118003, 195806, 113563, 594759,
  104868, 768852, 786191, 119461, 302224, 661895, 107158, 109886, 678266, 815262, 625912, 886846,
  257498, 235127, 781970, 732703, 129082, 751913, 845692, 199316, 142948, 375816, 107248, 277110,
  852066, 2763, 460696, 481200, 847591, 130520, 115620, 705770, 652766, 457892, 571684, 741995,
  173513, 443405, 185982, 842660, 112699, 438568, 589375, 893999, 240985, 713420, 907144, 228141,
  348282, 683459, 208161, 497386, 327896, 148559, 257704, 901886, 789003, 854601, 496880, 128072,
  751430, 834119, 671726, 119176, 123250, 916545, 187302, 762540, 228854, 449397, 108965, 109425,
  917936, 725872, 433058, 228310, 882994, 161178, 80025, 109553,
];

type MerchantFilter = {
  matcher: (searchOptions: Partial<ShopSearchOptions>) => boolean;
  merchantParam: { key: string; value: string };
};

const merchantFilters: MerchantFilter[] = [
  {
    matcher: (searchOptions) => !!searchOptions.collection?.includes('vitamins-supplements'),
    merchantParam: { key: 'wmid', value: '105100,611700' },
  },
  // {
  //   matcher: (searchOptions) => {
  //     const toMatch = ['adidas', '83', 'nike', '105', 'puma', '337'];
  //     if (searchOptions.brand?.split(',').some((e) => toMatch.includes(e))) return true;
  //     else if (searchOptions.query?.split(',').some((e) => toMatch.includes(e))) return true;
  //     else return false;
  //   },
  //   merchants: '104929,105275,968,107040,106871,1024,882350,350,62,61',
  // },
  // {
  //   matcher: (searchOptions) => {
  //     const toMatch = ['philips', '1171'];
  //     if (searchOptions.brand?.split(',').some((e) => toMatch.includes(e))) return true;
  //     else if (searchOptions.query?.split(',').some((e) => toMatch.includes(e))) return true;
  //     else return false;
  //   },
  //   merchants: '4513,106320,105330,106446,106320',
  // },
];

export const getMerchantParam = (searchOptions: Partial<ShopSearchOptions>) =>
  merchantFilters.find((e) => e.matcher(searchOptions))?.merchantParam;

const bannedProducts = [
  '579841675',
  '1560975449',
  '1549128371',
  '1474643637',
  '1512915051',
  '1580304999',
  '1580315859',
  '1470769567',
  '1291412943',
  '1561145057',
  '1550647669',
  '1585206397',
  '274392451',
  '65230441',
  '116786017',
  '1585113327',
];

export const isBannedProduct = <T extends { id: string }>(product: T): boolean => {
  let resolvedId = product.id;
  if (!isNaN(parseInt(product.id))) resolvedId = product.id.toString().split('-')[0];
  const match = bannedProducts.find((e) => resolvedId.includes(e));
  return !!match;
};

export const isNotBannedProduct = <T extends { id: string }>(product: T): boolean =>
  !isBannedProduct(product);
